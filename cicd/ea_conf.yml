# Variable size of Matrix

.multi_target:
    parallel:
        matrix:
            - FPGA_BOARD: [u55c,u280]
              EA: [acme]

.implementation_dependencies:              
  dependencies:
    - "synthesis: [u280, acme]"
    - "synthesis: [u55c, acme]"

.bitstream_dependencies: 
  dependencies:
    - "synthesis: [u280, acme]"
    - "synthesis: [u55c, acme]"          
    - "implementation: [u280, acme]"
    - "implementation: [u55c, acme]"
.fpga-test_dependencies:
  dependencies:
    - "synthesis: [u280, acme]"
    - "synthesis: [u55c, acme]"
    - "implementation: [u280, acme]"
    - "implementation: [u55c, acme]"
    - "EA-sdk: [u280, acme]"
    - "EA-sdk: [u55c, acme]"
    - "bitstream: [u280, acme]"
    - "bitstream: [u55c, acme]"
    #- "bitstream: [vcu128]"
.deploy_dependencies:
  dependencies:
    - "bitstream: [u280, acme]"
    - "bitstream: [u55c, acme]"
    #- "bitstream: [vcu128]"
    - "fpga-test: [u280, acme]"
    - "fpga-test: [u55c, acme]"
    #- "fpga-test: [vcu128]"

.default_tags:
  tags:
    - MEEP_FPGA


.common_conf:
  rules:
    - !reference [.default_rules, rules]    
  variables:
    GIT_SUBMODULE_STRATEGY: "none"
  #parallel: !reference [.multi_target, parallel]  
  timeout: 8h
  tags: !reference [.default_tags, tags] 
  # Don't block successfull builds in the matrix:
  # This would benefit from variable dependencies/needs, but that's not supported
  allow_failure: true  
